(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,a){e.exports=a.p+"static/media/CloseIcon.7fc20204.svg"},21:function(e,t,a){e.exports=a.p+"static/media/logo.7baba3c1.svg"},22:function(e,t,a){e.exports=a.p+"static/media/Edit.119609a3.svg"},23:function(e,t,a){e.exports=a.p+"static/media/EditButton.b05083e5.svg"},24:function(e,t,a){e.exports=a.p+"static/media/AddButton.21ec100a.svg"},25:function(e,t,a){e.exports=a.p+"static/media/Trash.4220563a.svg"},26:function(e,t,a){e.exports=a.p+"static/media/Vector.d99c316f.svg"},27:function(e,t,a){e.exports=a.p+"static/media/authSuccess.e38b395c.svg"},28:function(e,t,a){e.exports=a.p+"static/media/authFail.4072126c.svg"},29:function(e,t,a){e.exports=a(98)},38:function(e,t,a){},98:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),r=a(20),o=a.n(r),s=(a(38),a(5)),i=a(3),l=a(9),u=a(0),m=a(6),p=a(7),d=new(function(){function e(t){Object(m.a)(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}return Object(p.a)(e,[{key:"_checkRes",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}},{key:"register",value:function(e){var t=e.email,a=e.password;return fetch("".concat(this._baseUrl,"/signup"),{method:"POST",headers:this._headers,body:JSON.stringify({email:t,password:a})}).then(this._checkRes)}},{key:"login",value:function(e){var t=e.email,a=e.password;return fetch("".concat(this._baseUrl,"/signin"),{method:"POST",headers:this._headers,body:JSON.stringify({email:t,password:a})}).then(this._checkRes)}},{key:"getMe",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(this._checkRes)}}]),e}())({baseUrl:"https://api.alexkuular.nomoreparties.co",headers:{"Content-Type":"application/json"}}),f=a(21),h=a.n(f),_=a(8),b=a.n(_);var g=function(e){var t=e.loggedIn,a=e.logOut,n=e.email,r=Object(u.p)(),o=Object(u.n)();return c.a.createElement("header",{className:"header"},c.a.createElement("img",{className:"header__logo",src:h.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f"}),E({loggedIn:t,pathname:o.pathname,email:n,signOut:function(){b.a.set("token",""),a(),r("/sign-in")},navToSignIn:function(){r("/sign-in")},navToSignUp:function(){r("/sign-up")}}))},E=function(e){var t=e.loggedIn,a=e.pathname,n=e.email,r=e.signOut,o=e.navToSignIn,s=e.navToSignUp;if(t)return c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"header__email"},n),c.a.createElement("button",{className:"header__btn header__btn-out",onClick:r},"\u0412\u044b\u0439\u0442\u0438"));switch(a){case"/sign-in":return c.a.createElement("button",{className:"header__btn",onClick:s},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f");case"/sign-up":return c.a.createElement("button",{className:"header__btn",onClick:o},"\u0412\u043e\u0439\u0442\u0438")}},v=a(22),k=a.n(v),N=a(23),C=a.n(N),O=a(24),j=a.n(O),y=a(25),S=a.n(y),I=a(26),w=a.n(I),U=Object(n.createContext)();var x=function(e){var t=e.card,a=e.onCardClick,r=e.onCardLike,o=e.onCardDelete,s=Object(n.useContext)(U),i=t.owner===s._id,l=t.likes&&t.likes.some(function(e){return e===s._id}),u="card__like ".concat(l&&"card__like_active");return c.a.createElement("article",{className:"card"},i&&c.a.createElement("button",{className:"card__delete",type:"button",onClick:function(){o(t)}},c.a.createElement("img",{className:"card__trash",src:S.a,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f"})),c.a.createElement("img",{className:"card__image",src:t.link,alt:t.name,onClick:function(){a(t)}}),c.a.createElement("div",{className:"card__title"},c.a.createElement("h2",{className:"card__name"},t.name),c.a.createElement("div",{className:"card__like-container"},c.a.createElement("button",{className:u,type:"button",onClick:function(){r(t)}},c.a.createElement("img",{src:w.a,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u043b\u0430\u0439\u043a"})),c.a.createElement("p",{className:"card__like-number"},t.likes?t.likes.length:0))))};var L=function(e){var t=e.onEditAvatar,a=e.onEditProfile,r=e.onAddPlace,o=e.onCardClick,s=e.onCardLike,i=e.cards,l=e.onCardDelete,u=Object(n.useContext)(U);return c.a.createElement("main",{className:"content"},c.a.createElement("section",{className:"profile"},c.a.createElement("div",{className:"profile__avatar"},c.a.createElement("button",{className:"profile__avatar-btnedit",type:"button",onClick:t},c.a.createElement("img",{className:"profile__avatar-edit",src:k.a,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f"})),c.a.createElement("img",{className:"profile__avatarimg",src:u.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440"})),c.a.createElement("div",{className:"profile__info"},c.a.createElement("div",{className:"profile__info-title"},c.a.createElement("h1",{className:"profile__info-name"},u.name),c.a.createElement("button",{className:"profile__info-btnborder",type:"button",onClick:a},c.a.createElement("img",{className:"profile__info-btn",src:C.a,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f"}))),c.a.createElement("p",{className:"profile__info-identity"},u.about)),c.a.createElement("button",{className:"profile__button",type:"button",onClick:r},c.a.createElement("img",{className:"profile__button-plus",src:j.a,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f"}))),c.a.createElement("section",{className:"cards",id:"cards"},i.map(function(e){return c.a.createElement(x,{key:e._id,card:e,onCardClick:o,onCardLike:s,onCardDelete:l})})))};var T=function(){return c.a.createElement("footer",{className:"footer"},c.a.createElement("p",{className:"footer__copyright"},"\xa9 ",(new Date).getFullYear()," Mesto Russia"))},P=a(12),R=a.n(P);var A=function(e){return c.a.createElement("div",{className:"popup popup_image ".concat(e.isOpen?"popup_opened":""),id:"popupImage"},c.a.createElement("div",{className:"popup__containerImage"},c.a.createElement("button",{className:"popup__btnborder",type:"button"},c.a.createElement("img",{className:"popup__btn-close",id:"popup__btn-closeImage",src:R.a,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u044f",onClick:e.onClose})),c.a.createElement("img",{className:"popup__image",id:"imageSrc",src:e.card.link,alt:e.card.name}),c.a.createElement("h2",{className:"popup__image-name",id:"imageName"},e.card.name)))};var D=function(e){return c.a.createElement("div",{className:"popup popup_".concat(e.name," ").concat(e.isOpen?"popup_opened":"")},c.a.createElement("div",{className:"popup__container"},c.a.createElement("button",{className:"popup__btnborder",type:"button",onClick:e.onClose},c.a.createElement("img",{className:"popup__btn-close",id:"popup__btn-closeProfile",src:R.a,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u044f"})),c.a.createElement("h2",{className:"popup__container-edit"},e.title),c.a.createElement("form",{className:"popup__form popup__form-".concat(e.name),name:e.name,onSubmit:e.onSubmit},e.children,c.a.createElement("button",{className:"popup__btn-save",type:"submit"},e.textBtn))))},B=new(function(){function e(t){Object(m.a)(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}return Object(p.a)(e,[{key:"_checkRes",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:this._headers}).then(this._checkRes)}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:this._headers}).then(function(t){return e._checkRes(t)})}},{key:"setUserInfo",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkRes)}},{key:"addCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,"Content-Type":"application/json",body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkRes)}},{key:"changeAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._checkRes)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkRes)}},{key:"_putLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:"PUT",headers:this._headers}).then(this._checkRes)}},{key:"_deleteLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:"DELETE",headers:this._headers}).then(this._checkRes)}},{key:"likeCard",value:function(e){var t=e.idCard;return e.isLiked?this._deleteLike(t):this._putLike(t)}}]),e}())({baseUrl:"https://api.alexkuular.nomoreparties.co",headers:{authorization:"Bearer ".concat(b.a.get("token")),"Content-Type":"application/json"}});var F=function(e){var t=e.isOpen,a=e.onClose,r=e.onUpdateUser,o=Object(n.useContext)(U),s=Object(n.useState)(""),l=Object(i.a)(s,2),u=l[0],m=l[1],p=Object(n.useState)(""),d=Object(i.a)(p,2),f=d[0],h=d[1];return Object(n.useEffect)(function(){m(o.name),h(o.about)},[o,t]),c.a.createElement(D,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"editProfile",textBtn:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),r({name:u,about:f})}},c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{className:"popup__input",type:"text",name:"name",id:"fullnameInput",minLength:"2",maxLength:"40",value:u||"",required:!0,onChange:function(e){return m(e.target.value)}}),c.a.createElement("span",{className:"error",id:"fullnameInput-error"}),c.a.createElement("input",{className:"popup__input",type:"text",name:"identity",id:"identityInput",minLength:"2",maxLength:"200",value:f||"",required:!0,onChange:function(e){return h(e.target.value)}}),c.a.createElement("span",{className:"error",id:"identityInput-error"})))};var q=function(e){var t=e.isOpen,a=e.onClose,r=e.onUpdateAvatar,o=Object(n.useRef)();return Object(n.useEffect)(function(){o.current.value=""},[t]),c.a.createElement(D,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"editAvatar",textBtn:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),r({avatar:o.current.value})}},c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{className:"popup__input",type:"url",name:"link",id:"avatarLinkInput",autoComplete:"off",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",ref:o,required:!0}),c.a.createElement("span",{className:"error",id:"avatarLinkInput-error"})))};var J=function(e){var t=e.isOpen,a=e.onClose,r=e.onAddPlace,o=Object(n.useRef)(),s=Object(n.useRef)();return Object(n.useEffect)(function(){o.current.value="",s.current.value=""},[t]),c.a.createElement(D,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add",textBtn:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),r({name:o.current.value,link:s.current.value})}},c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{className:"popup__input",type:"text",name:"imgName",id:"cardNameInput",autoComplete:"off",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"2",maxLength:"30",ref:o,required:!0}),c.a.createElement("span",{className:"error",id:"cardNameInput-error"}),c.a.createElement("input",{className:"popup__input",type:"url",name:"link",id:"cardLinkInput",autoComplete:"off",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",ref:s,required:!0}),c.a.createElement("span",{className:"error",id:"cardLinkInput-error"})))},G=a(4),M=a(18);var z=function(e){var t=e.onSubmit,a=Object(n.useState)({email:"",password:""}),r=Object(i.a)(a,2),o=r[0],s=r[1],l=(Object(u.p)(),function(e){var t=e.target,a=t.name,n=t.value;s(Object(M.a)({},o,Object(G.a)({},a,n)))});return c.a.createElement("section",{className:"auth"},c.a.createElement("h2",{className:"auth__title"},"\u0412\u0445\u043e\u0434"),c.a.createElement("form",{className:"auth__form popup__form"},c.a.createElement("input",{className:"auth__input",type:"emil",name:"email",id:"email",placeholder:"Email",onChange:l,value:o.email,required:!0}),c.a.createElement("span",{className:"error",id:"fullnameInput-error"}),c.a.createElement("input",{className:"auth__input",type:"password",name:"password",id:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",onChange:l,value:o.password,required:!0}),c.a.createElement("button",{className:"auth__btn",onClick:function(e){e.preventDefault(),o.email&&o.password&&t(o)}},"\u0412\u043e\u0439\u0442\u0438")))};var H=function(e){var t=e.onSubmit,a=Object(n.useState)({email:"",password:""}),r=Object(i.a)(a,2),o=r[0],s=r[1],m=Object(u.p)(),p=function(e){var t=e.target,a=t.name,n=t.value;s(Object(M.a)({},o,Object(G.a)({},a,n)))};return c.a.createElement("section",{className:"auth"},c.a.createElement("h2",{className:"auth__title"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),c.a.createElement("form",{className:"auth__form popup__form"},c.a.createElement("input",{className:"auth__input",type:"emil",name:"email",id:"email",placeholder:"Email",onChange:p,value:o.email,required:!0}),c.a.createElement("span",{className:"error",id:"fullnameInput-error"}),c.a.createElement("input",{className:"auth__input",type:"password",name:"password",id:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",onChange:p,value:o.password,required:!0}),c.a.createElement("button",{className:"auth__btn",onClick:function(e){e.preventDefault(),t(o),m("/sign-in")}},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f")),c.a.createElement("p",{className:"auth__link"},c.a.createElement(l.b,{to:"/sign-in",className:"auth__link"},"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b? \u0412\u043e\u0439\u0442\u0438")))};var V=function(e){var t=e.element;return e.loggedIn?t:c.a.createElement(u.a,{to:"/sign-in",replace:!0})},Y=a(27),K=a.n(Y),Q=a(28),W=a.n(Q);var X=function(e){var t=e.open,a=e.message,n=e.status,r=e.onClose;return c.a.createElement("div",{className:"popup ".concat(t?"popup_opened":"")},c.a.createElement("div",{className:"popup__container"},c.a.createElement("button",{className:"popup__btnborder",type:"button",onClick:r},c.a.createElement("img",{className:"popup__btn-close",id:"popup__btn-closeProfile",src:R.a,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u044f"})),c.a.createElement("img",{className:"popup__auth-icon",src:function(e){switch(e){case"success":return K.a;case"fail":return W.a}}(n)}),c.a.createElement("h2",{className:"popup__auth-text"},a)))};var Z=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)(!1),m=Object(i.a)(o,2),p=m[0],f=m[1],h=Object(n.useState)(!1),_=Object(i.a)(h,2),E=_[0],v=_[1],k=Object(n.useState)(!1),N=Object(i.a)(k,2),C=N[0],O=N[1],j=Object(n.useState)({}),y=Object(i.a)(j,2),S=y[0],I=y[1],w=Object(n.useState)({}),x=Object(i.a)(w,2),P=x[0],R=x[1],G=Object(n.useState)([]),M=Object(i.a)(G,2),Y=M[0],K=M[1],Q=Object(n.useState)(!1),W=Object(i.a)(Q,2),Z=W[0],$=W[1],ee=Object(n.useState)({open:!1,message:"",status:null}),te=Object(i.a)(ee,2),ae=te[0],ne=te[1],ce=Object(n.useState)(),re=Object(i.a)(ce,2),oe=re[0],se=re[1],ie=function(){ne({open:!0,message:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",status:"success"})},le=function(){ne({open:!0,message:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",status:"fail"})},ue=function(){r(!1),f(!1),v(!1),O(!1),ne({open:!1})};return Object(n.useEffect)(function(){Z&&Promise.all([B.getInitialCards(),B.getUserInfo()]).then(function(e){var t=Object(i.a)(e,2),a=t[0],n=t[1];console.log(a,n),K(a),R(n)}).catch(function(e){console.log(e)})},[Z]),Object(n.useEffect)(function(){b.a.get("token")&&$(!0)},[]),Object(n.useEffect)(function(){Z&&!oe&&function(){var e=b.a.get("token");e&&d.getMe(e).then(function(e){var t=e.data;t.email&&se(t.email)}).catch(function(e){console.log(e)})}()},[Z,oe]),c.a.createElement(U.Provider,{value:P},c.a.createElement("div",{className:"root"},c.a.createElement("div",{className:"page"},c.a.createElement(l.a,null,c.a.createElement(g,{loggedIn:Z,logOut:function(){$(!1)},email:oe}),c.a.createElement(u.d,null,c.a.createElement(u.b,{path:"/sign-up",element:Z?c.a.createElement(u.a,{to:"/"}):c.a.createElement(H,{onSubmit:function(e){var t=e.email,a=e.password;d.register({email:t,password:a}).then(function(){ie()}).catch(function(e){le()})}})}),c.a.createElement(u.b,{path:"/sign-in",element:Z?c.a.createElement(u.a,{to:"/"}):c.a.createElement(z,{onSubmit:function(e){var t=e.email,a=e.password;d.login({email:t,password:a}).then(function(e){e.token&&(b.a.set("token",e.token),$(!0))}).catch(function(e){le()})},loggedIn:Z})}),c.a.createElement(u.b,{path:"/",element:c.a.createElement(V,{element:c.a.createElement(L,{cards:Y,onEditProfile:function(){r(!a)},onAddPlace:function(){f(!p)},onEditAvatar:function(){v(!E)},onCardClick:function(e){O(!C),I(e)},onCardLike:function(e){var t=e.likes.some(function(e){return e===P._id});console.log(e),console.log(P),t?B._deleteLike(e._id).then(function(e){var t=e.card;K(function(e){return e.map(function(e){return e._id===t._id?t:e})})}).catch(function(e){console.log(e)}):B.likeCard({idCard:e._id,isLiked:t}).then(function(e){var t=e.card;K(function(e){return e.map(function(e){return e._id===t._id?t:e})})}).catch(function(e){console.log(e)})},onCardDelete:function(e){B.deleteCard(e._id).then(function(){K(function(t){return t.filter(function(t){return t._id!==e._id})})}).catch(function(e){console.log(e)})}}),loggedIn:Z})})),c.a.createElement(T,null))),c.a.createElement(X,{open:ae.open,message:ae.message,status:ae.status,onClose:ue}),c.a.createElement(F,{isOpen:a,onClose:ue,onUpdateUser:function(e){var t=e.name,a=e.about;B.setUserInfo({name:t,about:a}).then(function(e){R(e.user),ue()}).catch(function(e){console.log(e)})}}),c.a.createElement(J,{isOpen:p,onClose:ue,onAddPlace:function(e){B.addCard(e).then(function(e){var t=e.card;K([t].concat(Object(s.a)(Y))),ue()}).catch(function(e){console.log(e)})}}),c.a.createElement(q,{isOpen:E,onClose:ue,onUpdateAvatar:function(e){B.changeAvatar(e).then(function(e){var t=e.user;R(t),ue()}).catch(function(e){console.log(e)})}}),c.a.createElement(D,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"deleteCard",textBtn:"\u0414\u0430",onClose:ue}),c.a.createElement(A,{onClose:ue,card:S,isOpen:C})))},$=function(e){e&&e instanceof Function&&a.e(1).then(a.bind(null,99)).then(function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;a(e),n(e),c(e),r(e),o(e)})};o.a.createRoot(document.getElementById("root")).render(c.a.createElement(Z,null)),$()}},[[29,3,2]]]);
//# sourceMappingURL=main.008a28f2.chunk.js.map